varreadabilityVersion="0.4";varemailSrc='http://davehauenstein.com/readability/email.php';variframeLoads=0;(function(){varobjOverlay=document.createElement("div");varobjinnerDiv=document.createElement("div");vararticleTools=document.createElement("DIV");objOverlay.id="readOverlay";objinnerDiv.id="readInner";//Applyuser-selectedstyling:document.body.className=readStyle;objOverlay.className=readStyle;objinnerDiv.className=readMargin+""+readSize;//Setuptoolswidget//NOTETHEIMAGEURL'SHERE!!!!!!!!!!!!!!!!!//NOTETHEIMAGEURL'SHERE!!!!!!!!!!!!!!!!!//NOTETHEIMAGEURL'SHERE!!!!!!!!!!!!!!!!!articleTools.id="readTools";articleTools.innerHTML="\<ahref='#'onclick='returnwindow.location.reload()'title='Reloadoriginalpage'id='reload-page'>ReloadOriginalPage</a>\<ahref='#'onclick='javascript:window.print();'title='Printpage'id='print-page'>PrintPage</a>\<ahref='#'onclick='emailBox();returnfalse;'title='Emailpage'id='email-page'>EmailPage</a>\";objinnerDiv.appendChild(grabArticle());//GetthearticleandplaceitinsidetheinnerDivobjOverlay.appendChild(articleTools);objOverlay.appendChild(objinnerDiv);//Inserttheinnerdivintotheoverlay//FortotallyhosedHTML,addbodynodethatcan'tbefoundbecauseofbadHTMLorsomething.if(document.body==null){body=document.createElement("body");document.body=body;}document.body.innerHTML="";//Insertsthenewcontent:document.body.insertBefore(objOverlay,document.body.firstChild);})()functiongrabArticle(){varallParagraphs=document.getElementsByTagName("p");vartopDivCount=0;vartopDiv=null;vartopDivParas;vararticleContent=document.createElement("DIV");vararticleTitle=document.createElement("H1");vararticleFooter=document.createElement("DIV");//Replacealldoubled-up<BR>tagswith<P>tags,andremovefonts.varpattern=newRegExp("<br/?>[\r\n\s]*<br/?>","g");document.body.innerHTML=document.body.innerHTML.replace(pattern,"</p><p>").replace(/<\/?font[^>]*>/g,'');//Grabthetitlefromthe<title>tagandinjectitasthetitle.articleTitle.innerHTML=document.title;articleContent.appendChild(articleTitle);//Studyalltheparagraphsandfindthechunkthathasthebestscore.//Ascoreisdeterminedbythingslike:Numberof<p>'s,commas,specialclasses,etc.for(varj=0;j<allParagraphs.length;j++){parentNode=allParagraphs[j].parentNode;//Initializereadabilitydataif(typeofparentNode.readability=='undefined'){parentNode.readability={"contentScore":0};//Lookforaspecialclassnameif(parentNode.className.match(/(comment|meta|footer|footnote)/))parentNode.readability.contentScore-=50;elseif(parentNode.className.match(/((^|\\s)(post|hentry|entry[-]?(content|text|body)?|article[-]?(content|text|body)?)(\\s|$))/))parentNode.readability.contentScore+=25;//LookforaspecialIDif(parentNode.id.match(/(comment|meta|footer|footnote)/))parentNode.readability.contentScore-=50;elseif(parentNode.id.match(/^(post|hentry|entry[-]?(content|text|body)?|article[-]?(content|text|body)?)$/))parentNode.readability.contentScore+=25;}//Addapointfortheparagraphfoundif(getInnerText(allParagraphs[j]).length>10)parentNode.readability.contentScore++;//AddpointsforanycommaswithinthisparagraphparentNode.readability.contentScore+=getCharCount(allParagraphs[j]);}//Assignmentfromindexforperformance.Seehttp://www.peachpit.com/articles/article.aspx?p=31567&seqNum=5for(nodeIndex=0;(node=document.getElementsByTagName('*')[nodeIndex]);nodeIndex++)if(typeofnode.readability!='undefined'&&(topDiv==null||node.readability.contentScore>topDiv.readability.contentScore))topDiv=node;if(topDiv==null){topDiv=document.createElement('div');topDiv.innerHTML='Sorry,readabilitywasunabletoparsethispageforcontent.Ifyoufeellikeitshouldhavebeenableto,please<ahref="http://code.google.com/p/arc90labs-readability/issues/entry">letusknowbysubmittinganissue.</a>';}//REMOVESALLSTYLESHEETS...for(vark=0;k<document.styleSheets.length;k++){if(document.styleSheets[k].href!=null&&document.styleSheets[k].href.lastIndexOf("readability")==-1){document.styleSheets[k].disabled=true;}}//Removeallstyletagsinhead(notdoingthisonIE):varstyleTags=document.getElementsByTagName("style");for(varj=0;j<styleTags.length;j++)if(navigator.appName!="MicrosoftInternetExplorer")styleTags[j].textContent="";cleanStyles(topDiv);//RemovesallstyleattributestopDiv=killDivs(topDiv);//GoesinandremovesDIV'sthathavemorenon<p>stuffthan<p>stufftopDiv=killBreaks(topDiv);//Removesanyconsecutive<br/>'sintojustone<br/>//CleansoutjunkfromthetopDivjustincase:topDiv=clean(topDiv,"form");topDiv=clean(topDiv,"object");topDiv=clean(topDiv,"table",250);topDiv=clean(topDiv,"h1");topDiv=clean(topDiv,"h2");topDiv=clean(topDiv,"iframe");//Addthefooterandcontents:articleFooter.id="readFooter";articleFooter.innerHTML="\<ahref='http://www.arc90.com'><imgsrc='http://lab.arc90.com/experiments/readability/images/footer.png'></a>\<divclass='footer-right'>\<spanclass='version'>Readabilityversion"+readabilityVersion+"</span>\</div>\";articleContent.appendChild(topDiv);articleContent.appendChild(articleFooter);returnarticleContent;}//Gettheinnertextofanode-crossbrowsercompatibly.functiongetInnerText(e){if(navigator.appName=="MicrosoftInternetExplorer")returne.innerText;elsereturne.textContent;}//GetcharactercountfunctiongetCharCount(e,s){s=s||",";returngetInnerText(e).split(s).length;}functioncleanStyles(e){e=e||document;varcur=e.firstChild;//Ifwehadabadnode,there'snotmuchwecando.if(!e)return;//Removeanyrootstyles,ifwe'reable.if(typeofe.removeAttribute=='function')e.removeAttribute('style');//Gountiltherearenomorechildnodeswhile(cur!=null){if(cur.nodeType==1){//Removestyleattribute(s):cur.removeAttribute("style");cleanStyles(cur);}cur=cur.nextSibling;}}functionkillDivs(e){vardivsList=e.getElementsByTagName("div");varcurDivLength=divsList.length;//Gathercountsforothertypicalelementsembeddedwithin.//Traversebackwardssowecanremovenodesatthesametimewithouteffectingthetraversal.for(vari=curDivLength-1;i>=0;i--){varp=divsList[i].getElementsByTagName("p").length;varimg=divsList[i].getElementsByTagName("img").length;varli=divsList[i].getElementsByTagName("li").length;vara=divsList[i].getElementsByTagName("a").length;varembed=divsList[i].getElementsByTagName("embed").length;//Ifthenumberofcommasislessthan10(badsign)...if(getCharCount(divsList[i])<10){//Andthenumberofnon-paragraphelementsismorethanparagraphs//orotherominoussigns:if(img>p||li>p||a>p||p==0||embed>0){divsList[i].parentNode.removeChild(divsList[i]);}}}returne;}functionkillBreaks(e){e.innerHTML=e.innerHTML.replace(/(<br\s*\/?>(\s|&nbsp;?)*){1,}/g,'<br/>');returne;}functionclean(e,tags,minWords){vartargetList=e.getElementsByTagName(tags);minWords=minWords||1000000;for(vary=0;y<targetList.length;y++){//Ifthetextcontentisn'tladenwithwords,removethechild:if(getCharCount(targetList[y],"")<minWords){targetList[y].parentNode.removeChild(targetList[y]);}}returne;}functionemailBox(){varemailContainer=document.getElementById('email-container');if(null!=emailContainer){return;}varemailContainer=document.createElement('div');emailContainer.setAttribute('id','email-container');emailContainer.innerHTML='<iframesrc="'+emailSrc+'?pageUrl='+escape(window.location)+'&pageTitle='+escape(document.title)+'"scrolling="no"onload="removeFrame()"style="width:500px;height:490px;border:0;"></iframe>';document.body.appendChild(emailContainer);}functionremoveFrame(){++iframeLoads;if(iframeLoads>=6){varemailContainer=document.getElementById('email-container');if(null!=emailContainer){emailContainer.parentNode.removeChild(emailContainer);}//resetthecountiframeLoads=0;}}